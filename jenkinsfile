post {
        always {
            script {
                // ビルド結果を確認
                def status = currentBuild.result ?: 'SUCCESS'
                def message = (status != 'SUCCESS') ? "✘ ビルドに失敗したよ。。。" : "✅ ビルド成功したよ！"
                def discordWebhookURL = "https://discord.com/api/webhooks/1349409322505080882/QfYPNfhAk1Tp_3cPGHMaXy_wiutJQZyt0zRdwWeCjpSl52WaOYcWdkXcA42nYpxm7cuF"
                def slackWebhookURL = "https://hooks.slack.com/services/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"

                // Discord通知
                def discordPayload = """{
                    "username": "jenkins",
                    "content": "${message} - ビルド番号 : ${currentBuild.number}",
                    "embeds": [{
                        "title": "Jenkins ビルド結果",
                        "description": "ジョブ : ${env.JOB_NAME} - [ビルドログ](${env.BUILD_URL})",
                        "color": ${status == 'SUCCESS' ? 65280 : 16711680}
                    }]
                }"""

                sh """
                    curl -X POST -H "Content-Type: application/json" -d '${discordPayload.replace("'", "\\'")}' ${discordWebhookURL}
                """

                // Slack通知
                def slackPayload = """{
                    "text": "${message} - ビルド番号 : ${currentBuild.number}",
                    "attachments": [{
                        "title": "Jenkins ビルド結果",
                        "text": "ジョブ : ${env.JOB_NAME} - [ビルドログ](${env.BUILD_URL})",
                        "color": "${status == 'SUCCESS' ? '#36a64f' : '#FF0000'}"
                    }]
                }"""
                
                sh """
                    curl -X POST -H "Content-Type: application/json" -d '${slackPayload.replace("'", "\\'")}' ${slackWebhookURL}
                """
            }
        }
    }
}
